TODO:
    - matrix transpose is a pita
